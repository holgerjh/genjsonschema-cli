# genjsonschema-cli

Genjsonschema is a simple CLI for generating [JSON Schemas](https://json-schema.org) from YAML and JSON documents.
It supports the generation of one schema from multiple input files. If multiple files are given, schema generation only succeeds if the resulting schema would be valid for all input files at once.

## Installation

Using `go install`:

```bash
 go install https://github.com/holgerjh/genjsonschema-cli
```

Manually:

```bash
 go build && install -m 755 genjsonschema-cli ~/.local/bin  # assuming ~/.local/bin is in PATH
```

## Usage

`genjsonschema-cli create file1 [file2 [...]] [flags]`

Arguments:

| Arguments           | Description|
| ------------------- | -------    |
| file1 ... fileN     | Input file(s). Use '-' to read from STDIN. |
| -o, --output string | Output file. Default is STDOUT. |

## Details

The aim of genjsonschema is to guarantee that the resulting schema is valid for every input file it was generated from.

Therefore, the following semantics apply:

### Merge Semantics

If more than one input file is given, the files are merged under the following rules:

* Objects are deep-merged

* Lists are merged constructively. List order is not preserved, duplicate elements are removed.

* Scalar values are rejected, if they are not of the same type. Numbers and integers are considered the same type, and mixing them results in genjsonschema choosing the number over the integer.

### List Handling

The schema generated by genjsonschema always defines lists using the `anyOf` keyword for its items. In addition, lists won't be limited on length.

A schema generated from

```json
[1, true]
```

will thus accept a list with an undefined number of integers, booleans, and combinations thereof, but will reject other element types such as string.

#### Example

Given the schema generated from the JSON above, the following is accepted:

```YAML
[true, 2, false]
```

But the following is **not** accepted:

```YAML
[1, "foo"]
```

## Restrictions on input

YAML is only supported as far as there exists an equivalent JSON expression. Notably, mappings may only use strings as keys.

The following is fine:

```YAML
foo: "bar"  # ok because key "foo" is of type string
```

The following is **not** fine:

```YAML
42: "bar"  # not ok because 42 is an integer
```

Providing the above YAML will raise an error.
